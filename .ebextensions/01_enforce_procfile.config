option_settings:
  aws:elasticbeanstalk:application:environment:
    PORT: "5000"
    SERVER_PORT: "5000"
    _JAVA_OPTIONS: "-Dserver.port=5000 -Dspring.profiles.active=aws"

container_commands:
  001_force_port_5000:
    command: |
      cat > /var/app/current/Procfile << 'EOF'
      web: java -Dserver.port=5000 -Dspring.profiles.active=aws -jar target/credit_score_sys-0.0.1-SNAPSHOT.jar
      EOF
    leader_only: false
    
  002_verify_procfile:
    command: "cat /var/app/current/Procfile"
    leader_only: false

files:
  "/var/app/staging/Procfile":
    mode: "000644"
    owner: root
    group: root
    content: |
      web: java -Dserver.port=5000 -Dspring.profiles.active=aws -jar target/credit_score_sys-0.0.1-SNAPSHOT.jar
